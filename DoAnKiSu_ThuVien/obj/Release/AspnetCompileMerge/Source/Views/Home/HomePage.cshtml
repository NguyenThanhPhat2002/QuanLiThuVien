<!DOCTYPE html>

<html>
<head>
    <meta name="viewport" content="width=device-width" />
    <title>@ViewBag.Title</title>
    <style>
        .container #myCarousel{
            margin-top: 20px;
        }
        .intro_books{
            margin-top: 20px;
        }
        .intro_books #title_new{
            margin-bottom: 15px;
        }
        .intro_books .new_books ul li{
            list-style-type: none;
            margin-right: 20px;
            font-size: 20px;
            padding: 10px;
            cursor: pointer;
        }
        .item_selected {
            background-color: #007aff;
            color: #fff;
        }
        .item_hover{
            color: #007aff;
        }
        .intro_books .new_books .list_type_doc {
            padding-left: 0;
            border-bottom: 0.1px groove #DDDDDD;
            padding-bottom: 5px;
            margin-bottom: 20px;
        }
        #btn-detail {
            background-color: #007aff;
            border: none;
            margin-right: 20px;
        }
        .recommend_books {
            padding-right: 10px;
            padding-right: 10px;
            margin-bottom: 15px
        }
    </style>
</head>
<body>
    <div>

        <script>
            // Configs
            let liveChatBaseUrl = document.location.protocol + '//' + 'livechat.fpt.ai/v36/src'
            let LiveChatSocketUrl = 'livechat.fpt.ai:443'
            let FptAppCode = 'f7d5d26bc357e059e8f8e35419e47dec'
            let FptAppName = 'help reader'
            // Define custom styles
            let CustomStyles = {
                // header
                headerBackground: 'linear-gradient(86.7deg, #3353a2ff 0.85%, #31b7b7ff 98.94%)',
                headerTextColor: '#ffffffff',
                headerLogoEnable: false,
                headerLogoLink: 'https://chatbot-tools.fpt.ai/livechat-builder/img/Icon-fpt-ai.png',
                headerText: 'Hỗ trợ trực tuyến',
                // main
                primaryColor: '#6d9ccbff',
                secondaryColor: '#ecececff',
                primaryTextColor: '#ffffffff',
                secondaryTextColor: '#000000DE',
                buttonColor: '#b4b4b4ff',
                buttonTextColor: '#ffffffff',
                bodyBackgroundEnable: false,
                bodyBackgroundLink: '',
                avatarBot: 'https://chatbot-tools.fpt.ai/livechat-builder/img/bot.png',
                sendMessagePlaceholder: 'Nhập tin nhắn',
                // float button
                floatButtonLogo: 'https://chatbot-tools.fpt.ai/livechat-builder/img/Icon-fpt-ai.png',
                floatButtonTooltip: 'FPT.AI xin chào',
                floatButtonTooltipEnable: false,
                // start screen
                customerLogo: 'https://chatbot-tools.fpt.ai/livechat-builder/img/bot.png',
                customerWelcomeText: 'Vui lòng nhập tên của bạn',
                customerButtonText: 'Bắt đầu',
                prefixEnable: false,
                prefixType: 'radio',
                prefixOptions: ["Anh", "Chị"],
                prefixPlaceholder: 'Danh xưng',
                // custom css
                css: ''
            }
            // Get bot code from url if FptAppCode is empty
            if (!FptAppCode) {
                let appCodeFromHash = window.location.hash.substr(1)
                if (appCodeFromHash.length === 32) {
                    FptAppCode = appCodeFromHash
                }
            }
            // Set Configs
            let FptLiveChatConfigs = {
                appName: FptAppName,
                appCode: FptAppCode,
                themes: '',
                styles: CustomStyles
            }
            // Append Script
            let FptLiveChatScript = document.createElement('script')
            FptLiveChatScript.id = 'fpt_ai_livechat_script'
            FptLiveChatScript.src = liveChatBaseUrl + '/static/fptai-livechat.js'
            document.body.appendChild(FptLiveChatScript)
            // Append Stylesheet
            let FptLiveChatStyles = document.createElement('link')
            FptLiveChatStyles.id = 'fpt_ai_livechat_script'
            FptLiveChatStyles.rel = 'stylesheet'
            FptLiveChatStyles.href = liveChatBaseUrl + '/static/fptai-livechat.css'
            document.body.appendChild(FptLiveChatStyles)
            // Init
            FptLiveChatScript.onload = function () {
                fpt_ai_render_chatbox(FptLiveChatConfigs, liveChatBaseUrl, LiveChatSocketUrl)
            }
        </script>
        <div class="container">
            <div class="container">
                <div id="myCarousel" class="carousel slide" data-ride="carousel">
                    <!-- Indicators -->
                    <ol class="carousel-indicators">
                        <li data-target="#myCarousel" data-slide-to="0" class="active"></li>
                        <li data-target="#myCarousel" data-slide-to="1"></li>
                        <li data-target="#myCarousel" data-slide-to="2"></li>
                        <li data-target="#myCarousel" data-slide-to="3"></li>
                        <li data-target="#myCarousel" data-slide-to="4"></li>
                    </ol>

                    <!-- Wrapper for slides -->
                    <div class="carousel-inner">

                        <div class="item active">
                            <img src="~/Content/images/posts/post1.jpg" style="width:100%;">
                            <div class="carousel-caption">

                            </div>
                        </div>

                        <div class="item">
                            <img src="~/Content/images/posts/post2.jpg" style="width:100%;">

                        </div>

                        <div class="item">
                            <img src="~/Content/images/posts/post3.jpg" style="width:100%;">

                        </div>
                        <div class="item">
                            <img src="~/Content/images/posts/post4.jpg" style="width:100%;">

                        </div>
                        <div class="item">
                            <img src="~/Content/images/posts/post5.jpg" style="width:100%;">

                        </div>

                    </div>

                    <!-- Left and right controls -->
                    <a class="left carousel-control" href="#myCarousel" data-slide="prev">
                        <span class="glyphicon glyphicon-chevron-left"></span>
                        <span class="sr-only">Previous</span>
                    </a>
                    <a class="right carousel-control" href="#myCarousel" data-slide="next">
                        <span class="glyphicon glyphicon-chevron-right"></span>
                        <span class="sr-only">Next</span>
                    </a>
                </div>
            </div>
            <!-- ========================= SECTION MAIN END// ========================= -->
        </div>
    </div>
    <div class="container intro_books">
        <div class="row">
            <div class="new_books">
                <h2 id="title_new">Giới thiệu sách</h2>
                <ul class="d-flex list_type_doc">
                    <li class="item_selected" id="book" data-type="book">Sách mới</li>
                    <li id="onl_doc" data-type="onl_doc">Tài liệu số</li>
                    <li id="speech" data-type="speech">Khóa luận tốt nghiệp</li>
                    <li id="speech" data-type="research">Nghiên cứu khoa học</li>
                    <li id="speech" data-type="thesis">Luận án</li>
                    <li id="speech" data-type="dissertation">Luận văn</li>
                </ul>
                <div class="row d-flex " id="matching_books">
                  
                </div>
                
            </div>
            
        </div>
    </div>
    <script>
        const liElements = document.querySelectorAll(".list_type_doc li");
        liElements.forEach(li => {
            li.addEventListener("click", () => {
                const loaiTaiLieu = li.getAttribute("data-type");
                liElements.forEach(i => i.classList.remove("item_selected"));
                // Thêm lớp 'selected' vào phần tử được click
                event.target.classList.add("item_selected");
                fetchData(loaiTaiLieu);
            });
        });
        document.addEventListener("DOMContentLoaded", () => {
            fetchData("book"); // Gọi hàm fetchData với tham số mặc định

        });




        async function fetchData(loaiTaiLieu) {
            const params = {
                method: 'GET', // Phương thức yêu cầu

            };
            const url = `/TaiLieu/GetDocumentByCategory?type=${loaiTaiLieu}`;
            const response = await fetch(url, params);
                const data = await response.json();
                // Xử lý dữ liệu JSON và hiển thị danh sách
            const danhSachHTML = data.map(item => `    
            <div onClick ="viewDetail(${item.ID_TL})" class = "col-3 recommend_books">
                <div style ="background-color: white;cursor: pointer; margin-right: 5px">
                    <img src="/Content/images/books/${item.AnhBia}" style="width:164px; height:235px; display:block;margin: auto" />
                    <b title="${item.TenTaiLieu}">${truncate(item.TenTaiLieu, 10)}</b>
                    <div class = "d-flex justify-content-between">
                    <p>${item.tg}</p>
                    <button id="btn-detail" class= "btn btn-primary">Chi tiết</button>
                    </div>

                </div>
            </div>
        `).join("");
                document.getElementById("matching_books").innerHTML = danhSachHTML;

        }
        function truncate(str, maxLines) {
            const words = str.split(' ');
            if (words.length > maxLines) {
                return words.slice(0, maxLines).join(' ') + '...';
            }
            return str;
        }
        function viewDetail(id) {
            const url = `/TaiLieu/Detail?id=${id}`;
            window.location.href = url;
        }
    </script>
</body>
</html>
